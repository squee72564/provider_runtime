{
  "provider": "anthropic",
  "scenario": "invalid_tool_payload",
  "captured_at": "2026-02-27T06:00:44.681Z",
  "request": {
    "url": "https://api.anthropic.com/v1/messages",
    "method": "POST",
    "model": "claude-sonnet-4-5-20250929",
    "headers": {
      "anthropic-version": "2023-06-01",
      "Content-Type": "application/json",
      "X-Api-Key": "<redacted>"
    },
    "body": {
      "system": "You are a helpful assistant.",
      "messages": [
        {
          "role": "user",
          "content": [
            {
              "type": "text",
              "text": "Use calculator"
            }
          ]
        }
      ],
      "tools": [
        {
          "name": "calculator",
          "description": "Evaluate math expressions",
          "input_schema": "invalid-input-schema"
        }
      ],
      "tool_choice": {
        "type": "tool",
        "name": "calculator"
      },
      "max_tokens": 64,
      "model": "claude-sonnet-4-5-20250929"
    }
  },
  "response": {
    "status": 400,
    "status_text": "Bad Request",
    "headers": {
      "anthropic-organization-id": "10be5498-85f2-41b8-b3d3-34353a601571",
      "cf-cache-status": "DYNAMIC",
      "cf-ray": "9d4576b30ed6f7a5-LAX",
      "connection": "keep-alive",
      "content-length": "183",
      "content-security-policy": "default-src 'none'; frame-ancestors 'none'",
      "content-type": "application/json",
      "date": "Fri, 27 Feb 2026 06:00:45 GMT",
      "request-id": "req_011CYY4fujNxNLPtamgvaMBp",
      "server": "cloudflare",
      "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
      "x-envoy-upstream-service-time": "47",
      "x-robots-tag": "none",
      "x-should-retry": "false"
    },
    "body": {
      "type": "error",
      "error": {
        "type": "invalid_request_error",
        "message": "tools.0.custom.input_schema: Input does not match the expected shape."
      },
      "request_id": "req_011CYY4fujNxNLPtamgvaMBp"
    }
  },
  "normalized_error": {
    "message": "Anthropic HTTP 400 Bad Request",
    "error_class": "AnthropicRouterHttpError"
  }
}